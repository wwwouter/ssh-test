box: wercker/default
build:
  steps:
    - wouter/setup-ssh:
        private-key: $SSH_KEY_PRIVATE
        host: ec2-54-221-7-78.compute-1.amazonaws.com
        username: ubuntu
    - wouter/script-ssh:
        name: Create source dir
        code: |
          sudo mkdir -p WERCKER_SOURCE_DIR
          sudo chown ubuntu WERCKER_SOURCE_DIR
    - script:
        name: Sync source dir
        code: rsync -avz --rsh="ssh -p1234  -i $WERCKER_SETUP_SSH_ID_FILE" "$WERCKER_SOURCE_DIR" $WERCKER_SETUP_SSH_USERNAME@$WERCKER_SETUP_SSH_HOST:"$WERCKER_SOURCE_DIR"
    - wouter/script-ssh:
        name: List source dir
        code: |
          cd $WERCKER_SOURCE_DIR
          ls -al


